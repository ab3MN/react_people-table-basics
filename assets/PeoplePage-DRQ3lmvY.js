import{j as e,L as j,c as l,r as i,u as N}from"./index-BufYRHuE.js";import{T as y}from"./Title-WDEwAEr8.js";const w=()=>e.jsx("div",{className:"Loader","data-cy":"loader",children:e.jsx("div",{className:"Loader__content"})}),b=({errorMessage:t,dataCy:s})=>e.jsx("p",{"data-cy":s,className:"has-text-danger",children:t}),m=({parent:t})=>e.jsx(j,{to:`/people/${t.slug}`,className:l("",{"has-text-danger":t.sex==="f"}),children:t.name}),L=({person:t,personId:s})=>{const{slug:n,name:a,sex:o,born:c,died:r,motherName:h,fatherName:d,mother:x,father:p}=t,u=h||"-",g=d||"-",f=x?e.jsx(m,{parent:x}):u,P=p?e.jsx(m,{parent:p}):g;return e.jsxs("tr",{"data-cy":"person",className:l({"has-background-warning":s===n}),children:[e.jsx("td",{children:e.jsx(j,{to:`/people/${n}`,className:l("",{"has-text-danger":o==="f"}),children:a})}),e.jsx("td",{children:o}),e.jsx("td",{children:c}),e.jsx("td",{children:r}),e.jsx("td",{children:f}),e.jsx("td",{children:P})]})},E="https://mate-academy.github.io/react_people-table/api/people.json";function S(t){return new Promise(s=>setTimeout(s,t))}function v(){return S(500).then(()=>fetch(E)).then(t=>t.json())}const M=t=>{const s=JSON.parse(JSON.stringify(t));return s.forEach((n,a)=>{const o=s.find(r=>r.name===n.motherName),c=s.find(r=>r.name===n.fatherName);o&&(s[a].mother=o),c&&(s[a].father=c)}),s},T=()=>{const[t,s]=i.useState([]),[n,a]=i.useState(!0),[o,c]=i.useState("");return i.useLayoutEffect(()=>{v().then(r=>{Array.isArray(r)?s(M(r)):c("Something went wrong")}).catch(r=>{console.log(r.message),c("Something went wrong")}).finally(()=>a(!1))},[]),{people:t,error:o,isLoading:n}},F=({personId:t})=>{const{people:s,isLoading:n,error:a}=T(),o=!s.length&&!n,c=()=>a?e.jsx(b,{dataCy:"peopleLoadingError",errorMessage:a}):o?e.jsx("p",{"data-cy":"noPeopleMessage",children:"There are no people on the server"}):s.length?e.jsxs("table",{"data-cy":"peopleTable",className:"table is-striped is-hoverable is-narrow is-fullwidth",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Sex"}),e.jsx("th",{children:"Born"}),e.jsx("th",{children:"Died"}),e.jsx("th",{children:"Mother"}),e.jsx("th",{children:"Father"})]})}),e.jsx("tbody",{children:s.map(r=>e.jsx(L,{person:r,personId:t},r.slug))})]}):null;return e.jsx("div",{className:"block",children:e.jsxs("div",{className:"box table-container",children:[n&&e.jsx(w,{}),c()]})})},k=()=>{const{personId:t}=N();return e.jsxs(e.Fragment,{children:[e.jsx(y,{text:"People Page"}),e.jsx(F,{personId:t})]})};export{k as default};
